# Highlights

- 精准距离计算方法：提出了一种可以通过识别基于静态分析可到达目标位置的程序路径的精确距离计算方法，可以有效的减少参与到距离计算的基本块数量并以此提高计算的精准度
- 定向变异方法：提出了一种基于污点分析对基本块中与程序输入处理相关的字节进行对应变异的方法。这种方法可以在fuzz的过程中对产生偏差的路径进行纠偏。解决了在定向fuzz中依赖随机变异的问题。
- 实际表现：触发程序崩溃的速度更快，与AFLGo, Beacon, WindRanger, and SelectFuzz这几个定向fuzzer相比都有明显提高，并且可以触发4个别的fuzzer不能触发的漏洞。

# Introduction

定向fuzz的一个核心要素的就是通过静态分析的手段结合一套距离指标给基本块设置了到达目标位置的距离，这个距离会被用于后续的fuzz种子选择上面（也就是选择离目标位置更近的种子进行后续变异）

现在的定向fuzzer存在一些缺点：

1. 首先在计算距离时其目标是整个代码空间，在AFLGO中对于每个函数间（未找到实际路径的函数间距离）的距离设定为10，这就使其无法区别一些长短种子
2. 当前的定向fuzzer虽然是基于距离引导的，但是在实际的fuzz进程中依赖的fuzz方法仍然是随机fuzz，这会导致其生成的很多的输入是无法正确到达目标位置的

根据以上两点，本文的核心工作就是两点：

1. 收缩距离计算的目标大小，不在对整个代码空间中的所有基本块和函数进行距离的计算（排除无关代码）
2. 根据分析发现每个基本块会对输入中的不同固定偏移上的字节进行处理，那么通过变异这些对应的字节就有可能把程序在偏移基本块处产生的执行偏差进行纠偏

在实现上，首先提取出目标项目的CG和CFG，并从中分析出程序入口点到目标位置的所有路径，结合静态分析的前后向分析找到所有与目标位置有关的所有韩硕或基本块。这些函数或基本块就是后面距离计算和插桩的对象（以此滤除无关的代码）